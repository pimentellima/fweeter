{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/mathe/OneDrive/Documentos/vsc/chatapp/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/mathe/OneDrive/Documentos/vsc/chatapp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/mathe/OneDrive/Documentos/vsc/chatapp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import TabHeader from\"./tabHeader\";import{Link}from\"react-router-dom\";import axios from\"axios\";import{useState,useEffect,useContext}from\"react\";import{AuthContext}from\"../contexts/authContext.js\";import{useNavigate}from\"react-router-dom\";import FweetForm from\"./fweetForm\";import Post from\"./post\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Home=function Home(){var _useContext=useContext(AuthContext),user=_useContext.user;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var navigate=useNavigate();useEffect(function(){user?fetchData():navigate('/login');},[]);var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"//localhost:5000/posts\",{params:{id:user.id}});case 3:res=_context.sent;setPosts(res.data);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 10:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();var sendData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(data){var user_id,user_name,user_username;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:user_id=user.id,user_name=user.name,user_username=user.username;_context2.prev=1;_context2.next=4;return axios.post('//localhost:5000/posts',{user_id:user_id,user_name:user_name,user_username:user_username,data:JSON.stringify(data),date:new Date().toISOString().slice(0,19).replace('T',' ')});case 4:_context2.next=9;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0);case 9:fetchData();case 10:case\"end\":return _context2.stop();}},_callee2,null,[[1,6]]);}));return function sendData(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"\",children:[/*#__PURE__*/_jsx(TabHeader,{children:/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"In\\xEDcio\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-flow-col grid-cols-10 py-2 pl-4 border-b border-stone-700 bg-inherit\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-span-1\",children:\"img\"}),/*#__PURE__*/_jsx(FweetForm,{sendData:sendData})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col\",children:posts.map(function(post){return/*#__PURE__*/_jsx(Post,{post:post});})})]});};export default Home;","map":{"version":3,"names":["TabHeader","Link","axios","useState","useEffect","useContext","AuthContext","useNavigate","FweetForm","Post","Home","user","posts","setPosts","navigate","fetchData","get","params","id","res","data","console","log","sendData","user_id","user_name","name","user_username","username","post","JSON","stringify","date","Date","toISOString","slice","replace","map"],"sources":["C:/Users/mathe/OneDrive/Documentos/vsc/chatapp/src/components/home.js"],"sourcesContent":["import TabHeader from \"./tabHeader\";\r\nimport { Link } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport { useState, useEffect, useContext } from \"react\";\r\nimport { AuthContext } from \"../contexts/authContext.js\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport FweetForm from \"./fweetForm\";\r\nimport Post from \"./post\";\r\n\r\nconst Home = () => {\r\n    const { user } = useContext(AuthContext);\r\n    const [posts, setPosts] = useState([]);\r\n    const navigate = useNavigate();\r\n\r\n    useEffect(() => {\r\n        user ? fetchData() : navigate('/login');\r\n    }, [])\r\n    \r\n    const fetchData = async() => {\r\n        try {\r\n            const res = await axios.get(`//localhost:5000/posts`, {\r\n                params: {\r\n                    id: user.id\r\n                }\r\n            });\r\n            setPosts(res.data)\r\n        } \r\n        catch(err) {\r\n            console.log(err);\r\n        }\r\n    }\r\n\r\n    const sendData = async (data) => {\r\n        const { id: user_id, name: user_name, username: user_username } = user;\r\n        try {\r\n            await axios.post('//localhost:5000/posts', {\r\n                user_id, \r\n                user_name,\r\n                user_username,\r\n                data: JSON.stringify(data),\r\n                date: new Date().toISOString().slice(0, 19).replace('T', ' ')\r\n            })\r\n        }\r\n        catch (err) {\r\n            console.log(err);\r\n        }\r\n        fetchData();\r\n    }\r\n\r\n    return(\r\n        <div className=\"\">\r\n            <TabHeader>\r\n                <Link to='/'>In√≠cio</Link>\r\n            </TabHeader>\r\n            <div className=\"grid grid-flow-col grid-cols-10 py-2 pl-4 border-b border-stone-700 bg-inherit\">\r\n                <div className=\"col-span-1\">img</div>\r\n                <FweetForm sendData={sendData}/>\r\n            </div>\r\n            <div className=\"flex flex-col\">\r\n                {posts.map(post => <Post post={post}/>)}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Home;"],"mappings":"4ZAAA,MAAOA,UAAS,KAAM,aAAa,CACnC,OAASC,IAAI,KAAQ,kBAAkB,CACvC,MAAOC,MAAK,KAAM,OAAO,CACzB,OAASC,QAAQ,CAAEC,SAAS,CAAEC,UAAU,KAAQ,OAAO,CACvD,OAASC,WAAW,KAAQ,4BAA4B,CACxD,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAOC,UAAS,KAAM,aAAa,CACnC,MAAOC,KAAI,KAAM,QAAQ,CAAC,wFAE1B,GAAMC,KAAI,CAAG,QAAPA,KAAI,EAAS,CACf,gBAAiBL,UAAU,CAACC,WAAW,CAAC,CAAhCK,IAAI,aAAJA,IAAI,CACZ,cAA0BR,QAAQ,CAAC,EAAE,CAAC,wCAA/BS,KAAK,eAAEC,QAAQ,eACtB,GAAMC,SAAQ,CAAGP,WAAW,EAAE,CAE9BH,SAAS,CAAC,UAAM,CACZO,IAAI,CAAGI,SAAS,EAAE,CAAGD,QAAQ,CAAC,QAAQ,CAAC,CAC3C,CAAC,CAAE,EAAE,CAAC,CAEN,GAAMC,UAAS,4FAAG,kLAEQb,MAAK,CAACc,GAAG,0BAA2B,CAClDC,MAAM,CAAE,CACJC,EAAE,CAAEP,IAAI,CAACO,EACb,CACJ,CAAC,CAAC,QAJIC,GAAG,eAKTN,QAAQ,CAACM,GAAG,CAACC,IAAI,CAAC,gFAGlBC,OAAO,CAACC,GAAG,aAAK,CAAC,mEAExB,kBAZKP,UAAS,0CAYd,CAED,GAAMQ,SAAQ,6FAAG,kBAAOH,IAAI,2JACZI,OAAO,CAA+Cb,IAAI,CAA9DO,EAAE,CAAiBO,SAAS,CAA8Bd,IAAI,CAAjDe,IAAI,CAAuBC,aAAa,CAAKhB,IAAI,CAAhCiB,QAAQ,yCAEpC1B,MAAK,CAAC2B,IAAI,CAAC,wBAAwB,CAAE,CACvCL,OAAO,CAAPA,OAAO,CACPC,SAAS,CAATA,SAAS,CACTE,aAAa,CAAbA,aAAa,CACbP,IAAI,CAAEU,IAAI,CAACC,SAAS,CAACX,IAAI,CAAC,CAC1BY,IAAI,CAAE,GAAIC,KAAI,EAAE,CAACC,WAAW,EAAE,CAACC,KAAK,CAAC,CAAC,CAAE,EAAE,CAAC,CAACC,OAAO,CAAC,GAAG,CAAE,GAAG,CAChE,CAAC,CAAC,0FAGFf,OAAO,CAACC,GAAG,cAAK,CAAC,OAErBP,SAAS,EAAE,CAAC,qEACf,kBAfKQ,SAAQ,6CAeb,CAED,mBACI,aAAK,SAAS,CAAC,EAAE,wBACb,KAAC,SAAS,wBACN,KAAC,IAAI,EAAC,EAAE,CAAC,GAAG,UAAC,WAAM,EAAO,EAClB,cACZ,aAAK,SAAS,CAAC,gFAAgF,wBAC3F,YAAK,SAAS,CAAC,YAAY,UAAC,KAAG,EAAM,cACrC,KAAC,SAAS,EAAC,QAAQ,CAAEA,QAAS,EAAE,GAC9B,cACN,YAAK,SAAS,CAAC,eAAe,UACzBX,KAAK,CAACyB,GAAG,CAAC,SAAAR,IAAI,qBAAI,KAAC,IAAI,EAAC,IAAI,CAAEA,IAAK,EAAE,GAAC,EACrC,GACJ,CAEd,CAAC,CAED,cAAenB,KAAI"},"metadata":{},"sourceType":"module","externalDependencies":[]}