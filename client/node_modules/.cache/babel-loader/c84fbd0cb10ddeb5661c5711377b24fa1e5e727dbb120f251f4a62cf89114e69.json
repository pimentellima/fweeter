{"ast":null,"code":"var _s = $RefreshSig$();\nimport axios from \"axios\";\nimport { useState, useEffect, useContext } from \"react\";\nimport { useLocation } from \"react-router-dom\";\nimport { AuthContext } from \"../../contexts/authContext\";\nimport { getUserByUrl } from \"../../services/getUserByUrl\";\nexport const useUserProfile = async () => {\n  _s();\n  const {\n    currentUser\n  } = useContext(AuthContext);\n  const [followed, setFollowed] = useState(false);\n  const [posts, setPosts] = useState([]);\n  const [user, setUser] = useState();\n  const location = useLocation();\n  useEffect(() => {\n    const user = getUserByUrl(location.pathname);\n    setUser(user);\n    if (user) {\n      const posts = getPostsById(user.id);\n      setPosts(posts);\n      fetchFollowed();\n    }\n  }, [user]);\n  const fetchFollowed = async () => {\n    try {\n      const res = await axios.get('//localhost:5000/follow', {\n        params: {\n          followed_user_id: user.id\n        }\n      });\n      res.data.forEach(item => {\n        if (item.follower_user_id === currentUser.id) {\n          setFollowed(true);\n        }\n      });\n    } catch (err) {\n      console.error(err);\n    }\n  };\n  const handleFollow = async () => {\n    try {\n      followed ? axios.delete('//localhost:5000/follow', {\n        data: {\n          follower_user_id: currentUser.id,\n          followed_user_id: user.id\n        }\n      }).then(() => setFollowed(false)) : axios.post('//localhost:5000/follow', {\n        follower_user_id: currentUser.id,\n        followed_user_id: user.id\n      }).then(() => setFollowed(true));\n    } catch (err) {\n      console.error(err);\n    }\n  };\n  return {\n    followed,\n    handleFollow,\n    user,\n    posts\n  };\n};\n_s(useUserProfile, \"TmKHO4pExE/x4Zv2DvNRR+Zu0gk=\", false, function () {\n  return [useLocation];\n});","map":{"version":3,"names":["axios","useState","useEffect","useContext","useLocation","AuthContext","getUserByUrl","useUserProfile","currentUser","followed","setFollowed","posts","setPosts","user","setUser","location","pathname","getPostsById","id","fetchFollowed","res","get","params","followed_user_id","data","forEach","item","follower_user_id","err","console","error","handleFollow","delete","then","post"],"sources":["C:/Users/mathe/OneDrive/Documentos/vsc/fwitter/client/src/modules/user/useUserProfile.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { useState, useEffect, useContext } from \"react\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport { AuthContext } from \"../../contexts/authContext\";\r\nimport { getUserByUrl } from \"../../services/getUserByUrl\";\r\n\r\nexport const useUserProfile = async() => {\r\n    const { currentUser } = useContext(AuthContext);\r\n    const [followed, setFollowed] = useState(false);\r\n    const [posts, setPosts] = useState([]);\r\n    const [user, setUser] = useState();\r\n    const location = useLocation();\r\n\r\n    useEffect(() => {\r\n        const user = getUserByUrl(location.pathname)\r\n        setUser(user);\r\n        \r\n        if(user) {\r\n            const posts = getPostsById(user.id);\r\n            setPosts(posts);\r\n            fetchFollowed();\r\n        }\r\n    }, [user])\r\n\r\n    const fetchFollowed = async () => {\r\n        try {\r\n            const res = await axios.get('//localhost:5000/follow', {\r\n                params: {\r\n                    followed_user_id: user.id\r\n                }\r\n            })\r\n    \r\n            res.data.forEach((item) => {\r\n                if(item.follower_user_id === currentUser.id) {\r\n                    setFollowed(true);\r\n                } \r\n            })\r\n        } catch(err) {\r\n            console.error(err);\r\n        }\r\n    }\r\n\r\n    const handleFollow = async() => {\r\n        try {\r\n            followed ? \r\n                axios.delete('//localhost:5000/follow', {\r\n                    data: {\r\n                        follower_user_id: currentUser.id,\r\n                        followed_user_id: user.id\r\n                    }\r\n                }).then(() => setFollowed(false))\r\n            :\r\n                axios.post('//localhost:5000/follow', {\r\n                    follower_user_id: currentUser.id,\r\n                    followed_user_id: user.id\r\n                }).then(() => setFollowed(true))\r\n        } catch(err) {\r\n            console.error(err);\r\n        }\r\n    }\r\n\r\n    return { followed, handleFollow, user, posts };\r\n}\r\n"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,QAAQ,EAAEC,SAAS,EAAEC,UAAU,QAAQ,OAAO;AACvD,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,WAAW,QAAQ,4BAA4B;AACxD,SAASC,YAAY,QAAQ,6BAA6B;AAE1D,OAAO,MAAMC,cAAc,GAAG,YAAW;EAAA;EACrC,MAAM;IAAEC;EAAY,CAAC,GAAGL,UAAU,CAACE,WAAW,CAAC;EAC/C,MAAM,CAACI,QAAQ,EAAEC,WAAW,CAAC,GAAGT,QAAQ,CAAC,KAAK,CAAC;EAC/C,MAAM,CAACU,KAAK,EAAEC,QAAQ,CAAC,GAAGX,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACY,IAAI,EAAEC,OAAO,CAAC,GAAGb,QAAQ,EAAE;EAClC,MAAMc,QAAQ,GAAGX,WAAW,EAAE;EAE9BF,SAAS,CAAC,MAAM;IACZ,MAAMW,IAAI,GAAGP,YAAY,CAACS,QAAQ,CAACC,QAAQ,CAAC;IAC5CF,OAAO,CAACD,IAAI,CAAC;IAEb,IAAGA,IAAI,EAAE;MACL,MAAMF,KAAK,GAAGM,YAAY,CAACJ,IAAI,CAACK,EAAE,CAAC;MACnCN,QAAQ,CAACD,KAAK,CAAC;MACfQ,aAAa,EAAE;IACnB;EACJ,CAAC,EAAE,CAACN,IAAI,CAAC,CAAC;EAEV,MAAMM,aAAa,GAAG,YAAY;IAC9B,IAAI;MACA,MAAMC,GAAG,GAAG,MAAMpB,KAAK,CAACqB,GAAG,CAAC,yBAAyB,EAAE;QACnDC,MAAM,EAAE;UACJC,gBAAgB,EAAEV,IAAI,CAACK;QAC3B;MACJ,CAAC,CAAC;MAEFE,GAAG,CAACI,IAAI,CAACC,OAAO,CAAEC,IAAI,IAAK;QACvB,IAAGA,IAAI,CAACC,gBAAgB,KAAKnB,WAAW,CAACU,EAAE,EAAE;UACzCR,WAAW,CAAC,IAAI,CAAC;QACrB;MACJ,CAAC,CAAC;IACN,CAAC,CAAC,OAAMkB,GAAG,EAAE;MACTC,OAAO,CAACC,KAAK,CAACF,GAAG,CAAC;IACtB;EACJ,CAAC;EAED,MAAMG,YAAY,GAAG,YAAW;IAC5B,IAAI;MACAtB,QAAQ,GACJT,KAAK,CAACgC,MAAM,CAAC,yBAAyB,EAAE;QACpCR,IAAI,EAAE;UACFG,gBAAgB,EAAEnB,WAAW,CAACU,EAAE;UAChCK,gBAAgB,EAAEV,IAAI,CAACK;QAC3B;MACJ,CAAC,CAAC,CAACe,IAAI,CAAC,MAAMvB,WAAW,CAAC,KAAK,CAAC,CAAC,GAEjCV,KAAK,CAACkC,IAAI,CAAC,yBAAyB,EAAE;QAClCP,gBAAgB,EAAEnB,WAAW,CAACU,EAAE;QAChCK,gBAAgB,EAAEV,IAAI,CAACK;MAC3B,CAAC,CAAC,CAACe,IAAI,CAAC,MAAMvB,WAAW,CAAC,IAAI,CAAC,CAAC;IACxC,CAAC,CAAC,OAAMkB,GAAG,EAAE;MACTC,OAAO,CAACC,KAAK,CAACF,GAAG,CAAC;IACtB;EACJ,CAAC;EAED,OAAO;IAAEnB,QAAQ;IAAEsB,YAAY;IAAElB,IAAI;IAAEF;EAAM,CAAC;AAClD,CAAC;AAAA,GAxDYJ,cAAc;EAAA,QAKNH,WAAW;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}